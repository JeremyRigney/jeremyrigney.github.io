<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>LOFAR Monitor 2.0</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Bootstrap Icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic" rel="stylesheet" type="text/css" />
        <!-- SimpleLightbox plugin CSS-->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.css" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="styles_monitor.css" rel="stylesheet" />

        <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
        <script src='https://cdn.plot.ly/plotly-2.24.1.min.js'></script>
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-light fixed-top py-3" id="mainNav">
            <div class="container px-4 px-lg-5">
                <a class="navbar-brand navbar-brand-cv" href="https://dias.ie/jeremy">I-LOFAR</a>
                <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ms-auto my-2 my-lg-0">
                        <li class="nav-item nav-item-cv"><a class="nav-link nav-link-cv" href="https://dias.ie/jeremy">Home</a></li>
                        <li class="nav-item nav-item-cv"><a class="nav-link nav-link-cv" href="index.html#about">About</a></li>
                        <li class="nav-item nav-item-cv"><a class="nav-link nav-link-cv" href="index.html#research">Research</a></li>
                        <li class="nav-item nav-item-cv"><a class="nav-link nav-link-cv" href="index.html#dashboard">Dashboard</a></li>
                        <li class="nav-item nav-item-cv"><a class="nav-link nav-link-cv" href="#page-top">CV</a></li>
                        <li class="nav-item nav-item-cv"><a class="nav-link nav-link-cv" href="#contact">Contact</a></li>
                        

                       
                    </ul>
                </div>
            </div>
        </nav>
        
        <!-- About-->
        <section class="page-section bg-tertiary" id="about">
            <div class="container px-4 px-lg-5">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-lg-8 text-center">
                        <!--<h2 class="text-black mt-0">SUNRAÍ (sonraí)</h2>-->
                    </div>
                    
                </div>
            </div>
        </section>

        <div class="col-sm-8">

         <div class="p-3 border rounded bg-light">
             <div id="chartContainer" style="height: 260px; width: 100%;"></div>
         </div>
        </div>

        <div class="p-3 border rounded bg-light">

            <div id='myDiv'></div>
        </div>
        <!-- Services-->

  
        <!-- Call to action-->
        <!--<section class="page-section bg-dark text-white">
            <div class="container px-4 px-lg-5 text-center">
                <h2 class="mb-4">Free Download at Start Bootstrap!</h2>
                <a class="btn btn-light btn-xl" href="https://startbootstrap.com/theme/creative/">Download Now!</a>
            </div>
        </section>-->
        <!-- Contact-->
        <section class="page-section" id="contact">
            <div class="container px-4 px-lg-5">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-lg-8 col-xl-6 text-center">
                        <h2 class="mt-0">Contact</h2>
                        <hr class="divider" />
                        <p class="text-muted mb-5">
                        Dublin Institute for Advanced Studies,</br>
                            31 Fitzwilliam Place,</br>
                            Dublin 2,</br>
                            Ireland</p>
                    </div>
                </div>

            </div>
            <div class="container px-4 px-lg-5">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-lg-4 text-center mb-5 mb-lg-0">
                        <i class="bi-mailbox fs-2 mb-3 text-muted"></i>
                        <p>jeremy.rigney@dias.ie</p><!--<img src='assets/email.png' height='38px'/>-->
                        <p><a href='https://twitter.com/jeremyrigney' target='_blank'><img src='assets/twitter.svg' height='45px' width='45px' style='margin-right:12px;'/></a><a href='https://www.linkedin.com/in/jeremyrigney/' target='_blank'><img src='assets/linkedin.svg' height='45px' width='45px' style='margin-left:12px;'/></a></p>
                    </div>
                </div>
            </div>

        </section>
        <!-- Footer-->
        <footer class="bg-light py-5">
            <div class="container px-4 px-lg-5"><div class="small text-center text-muted">Copyright &copy; 2022 - Jeremy Rigney</div></div>
        </footer>


        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- SimpleLightbox plugin JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>

        <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js'></script>
        <script src="https://code.jquery.com/jquery-1.6.4.js"></script>
        <script type='text/javascript'>
            //var goesdata;
             var goesDataShort;
             var goesDataLong;
            $.getJSON('https://services.swpc.noaa.gov/json/goes/primary/xrays-3-day.json', function(data) {

                const energy = data.map(i => `${i.energy}`);
                const obs_flux = data.map(i => `${i.observed_flux}`);
                
                const times = data.map(i => `${i.time_tag}`);

                
                var short = [];
                var long = [];

                var shortData = [];
                var longData = [];

                let idx = energy.indexOf('0.05-0.4nm');
                while (idx != -1) {
                  short.push(obs_flux[idx])
                  idx = energy.indexOf('0.05-0.4nm', idx + 1);
                  
                };

                for (const x1 of short.keys()){
                    var temp = {x:new Date(Date.parse(times[x1])), y:parseFloat(short[x1])};
                    shortData.push(temp);
                };


                let idx2 = energy.indexOf('0.1-0.8nm');
                while (idx2 != -1) {
                  long.push(obs_flux[idx2])
                  idx2 = energy.indexOf('0.1-0.8nm', idx2 + 1);
                };

                for (const x2 of long.keys()){
                    var temp = {x:new Date(Date.parse(times[x2])), y:parseFloat(long[x2])};
                    longData.push(temp);
                };

            

            //console.log(goesDataLong);
            //window.onload = function () {

                var chart = new CanvasJS.Chart("chartContainer", {
                    zoomEnabled: true,
                    zoomType: "xy",
                    exportEnabled: true,
                    title: {
                        text: "GOES 3-Day X-Ray Data",
                        fontWeight:"light",
                        fontSize:"16"
                    },
                    axisX: {
                        valueFormatString: "HH:MM:ss DD/MM",
                        title: "TIme and Date"
                    },
                    axisY: {
                        logarithmic: true,
                        title: "Energy",
                        prefix: "",
                        suffix: "",
                        maximum: 0.0005,
                        minimum: 0.00000001,
                        labelFormatter: function ( e ) {
                            var ret;
                            switch(e.value){
                                case 0.00000001:
                                    ret = "A";
                                    break;
                                case 0.0000001:
                                    ret = "B";
                                    break;
                                case 0.000001:
                                    ret = "C";
                                    break;
                                case 0.00001:
                                    ret = "M";
                                    break;
                                case 0.0001:
                                    ret = "X";
                                    break;
        
                            }
                        return ret;
                        }
                    },

                    toolTip: {
                        shared: true
                    },



                    legend: {
                        cursor: "pointer",
                        verticalAlign: "top",
                        horizontalAlign: "center",
                        dockInsidePlotArea: true,
                        itemclick: toogleDataSeries
                    },
                    data: [{
                        type:"line",
                        //axisYType: "secondary",
                        name: "GOES 0.05-0.4 nm",
                        color:'#002DF5',
                        showInLegend: true,
                        markerSize: 1,
                        yValueFormatString: "#.##########",
                        dataPoints: shortData,
                        
                    },
                    {
                        type: "line",
                        //axisYType: "secondary",
                        name: "GOES 0.1-0.8 nm",
                        color:'#F3A83B',
                        showInLegend: true,
                        markerSize: 1,
                        yValueFormatString: "#.##########",
                        dataPoints: longData,

                    },
                    
                    ]
                });
                chart.render();
                
                function toogleDataSeries(e){
                    if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
                        e.dataSeries.visible = false;
                    } else{
                        e.dataSeries.visible = true;
                    }
                    chart.render();
                }
            
            //console.log(longData);
            //}
        });



        </script>

        <script type ='text/javascript'>
            d3.csv("https://raw.githubusercontent.com/plotly/datasets/master/finance-charts-apple.csv", function(err, rows){

  function unpack(rows, key) {
  return rows.map(function(row) { return row[key]; });
}


var trace1 = {
  type: "scatter",
  mode: "lines",
  name: 'AAPL High',
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'AAPL.High'),
  line: {color: '#17BECF'}
}

var trace2 = {
  type: "scatter",
  mode: "lines",
  name: 'AAPL Low',
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'AAPL.Low'),
  line: {color: '#7F7F7F'}
}

var data = [trace1,trace2];

var layout = {
  title: 'Time Series with Rangeslider',
  xaxis: {
    autorange: true,
    range: ['2015-02-17', '2017-02-16'],
    rangeselector: {buttons: [
        {
          count: 1,
          label: '1m',
          step: 'month',
          stepmode: 'backward'
        },
        {
          count: 6,
          label: '6m',
          step: 'month',
          stepmode: 'backward'
        },
        {step: 'all'}
      ]},
    rangeslider: {range: ['2015-02-17', '2017-02-16']},
    type: 'date'
  },
  yaxis: {
    autorange: true,
    range: [86.8700008333, 138.870004167],
    type: 'linear'
  }
};

Plotly.newPlot('myDiv', data, layout);
})

        </script>    
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
    </body>
</html>
