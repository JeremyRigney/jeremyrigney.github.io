<!DOCTYPE HTML>
<!--
	Stellar by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Jeremy Rigney | Blog</title>
		<meta charset="utf-8" />
		<!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="images/favicon.png"/>
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
		<meta name="author" content="Jeremy Rigney">
		<meta name="description" content="I hold a PhD in astrophysics from Queen's University Belfast. My research focused on observing the Sun and other stars using some of the largest and most advanced telescopes in the world to better understand stellar dynamics. Throughout my PhD I have presented my research at international conferences, and published peer reviewed research, collaborating with colleagues across the globe."/>
		<meta name="keywords" content="Jeremy Rigney, Jeremy, astronomy ireland, irish astronomy, jeremy astronomy, jeremy irish astronomy, jeremy science communication, science communication ireland, Jeremy Rigney astro, Dublin Institute for Advanced Studies, AOP, Armagh Observatory, Queen's University Belfast, Lindsay Scholar, jeremy queens, jeremy dias, jeremy armagh"/>


		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Cormorant:ital,wght@0,300..700;1,300..700&display=swap" rel="stylesheet">


		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
 		<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
 		<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>


		<script type='text/javascript'>
        	function toggleMenu() {
        	    var menu = document.getElementById("menu");
        	    if (menu.style.display === "flex") {
        	        menu.style.display = "none";
        	    } else {
        	        menu.style.display = "flex";
        	    }
        	}
    	</script>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">


				<div class="hamburger" onclick="toggleMenu()">
   				    <div class="bar"></div>
   				    <div class="bar"></div>
   				    <div class="bar"></div>
   				</div>
   				<div class="menu" id="menu">
    			    <a href="https://jeremy.ie" class="active">Home</a>
					<a href="https://jeremy.ie/cv">CV</a>
					<a href="#cta">Contact</a>
    			</div>

				<!-- Nav -->
					<nav id="nav">
						<ul>
							<li><a href="https://jeremy.ie" class="active">Home</a></li>
							<li><a href="https://jeremy.ie/cv">CV</a></li>
							<li><a href="#cta">Contact</a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Content -->
							
				<section id="first" class="main">
		            
		        <div class="content" style='max-width: 970px; margin:0px auto;'>
		            <h2 class="text-center mt-0">Data Dashboard</h2>

		            <p>A collection of widgets I have created and collated, added to semi-regularly. The Irish Rail, arXiv summaries, GOES Plot, Solar Info and solar images are all live widgets I developed from scratch, pulling from publicly available data. The weather and lunar phase widgets are lightly modified from free, pre-existing widgets.


		            <ul>
					  <li>Irish Rail Live Train Information. JavaScript pulls from an API I built running via a flask app. The flask app is hosted on Google Cloud hub. Data updated in realtime (~1 minute).</li>
					  <li>The arXiv summaries pull from the arXiv API, filtered to only search and return papers related to solar and stellar flares (ideally with radio data). This provided an at-a-glance summary of daily papers related to my PhD thesis work.</li>
					  <li>The weather and lunar phase widgets are pre-built, the only modifications are style and locations.</li>
					  <li>The GOES live plot pulls data from the GOES satellite live JSON files. The data are live X-ray flux of the full solar disk. Bright peaks correspond to solar flares, classified from A-X, with X being the most powerful (y-axis). THe plot is a 3-day summary, and is near-realtime. It utilises canvasJS to plot the data.</li>
					  <li>The Solar Info again uses JS to pull from a live JSON file, location dependent. The solar images adjacent are near-realtime (-15 mins) NASA SDO AIA images.</li>
					</ul>
		            </p>

		          <div class="row gtr-uniform">
		          <div class="col-12">
		          <h3>Live Irish Rail Train Positions (Interactive)</h3>
				  <div id="trainmap" style=" height: 600px; width: 70%; border-radius:10px; margin:0px auto;"></div>
				  
				  </div>
				  </div>
		            
				</br>
		        <span style=''>Recent arXiv articles related to flare stars:</span>
		            <div class="row gtr-uniform" style='margin-top:20px;'>

		              <div class="col-4">
		                
		                <div class="p-3" style=' background: #f5f5f5; border-radius:5px;padding:10px;'><!-- style='border-radius: 12px; background: #fff; box-shadow:  -7px 7px 14px #d0d0d0, 7px -7px 14px #f0f0f0;'> -->

		                    <div height='70px' style='line-height:20px; text-align:center; color:#000; padding-top:20px; border-radius:4px;'>
		                    <span class='firsttitle'></span>
		                    </div>

		                    <div height='50px' style='line-height:16px; text-align:left; color:#000; font-size:11px; margin-top:20px; padding:20px;'>
		                    <i><span class='authorp1'></span> et al.</br></br></i>
		                    <span class='firstabstract'></span>...
		                    </div>

		                    <!-- <div style='text-align:center;line-height:15px; color:#000; font-size:13px;  margin-top:30px;'><span class='link1'></span></div>-->
		                    
		                    <button class="link1 button">Read  on arXiv</button>

		                </div>

		              </div>


		            
		              <div class="col-4">
		                
		                <div class="p-3" style=' background: #f5f5f5; border-radius:5px; padding:10px;'>

		                    <div height='70px' style='line-height:20px; text-align:center; color:#000; padding-top:20px; border-radius:4px;'>
		                    <span class='secondtitle'></span>
		                    </div>

		                    <div height='50px' style='line-height:16px; text-align:left; color:#000; font-size:11px; margin-top:20px; padding:20px;'>
		                    <i><span class='authorp2'></span> et al.</br></br></i>
		                    <span style='height:100px; overflow-y:hidden;' class='secondabstract'></span>...
		                    </div>

		                    <!-- <div style='text-align:center;line-height:15px; color:#fff; font-size:13px;  margin-top:30px;'><span class='link2'></span></div>-->
		                    <button class="link2 button">Read  on arXiv</button>

		                </div>
		              </div>


		              <div class="col-4">
		                
		               <div class="p-3" style=' background: #f5f5f5; border-radius:5px; padding:10px;'><!-- style='background-color:#02364C;'>-->

		                    <div height='70px' style='line-height:20px; text-align:center; color:#000; padding-top:20px; border-radius:4px;'>
		                    <span class='thirdtitle'></span>
		                    </div>

		                    <div height='50px' style='line-height:16px; text-align:left; color:#000; font-size:11px; margin-top:20px; padding:20px;'>
		                    <i><span class='authorp3'></span> et al.</br></br></i>
		                    <span class='thirdabstract'></span>...
		                    </div>

		                    <!--<div style='text-align:center;line-height:15px; color:#fff; font-size:13px;  margin-top:30px;'><span class='link3'></span></div>-->
		                    <button class="link3 button">Read  on arXiv</button>
		                </div>
		              </div>
		            
		            </div>







		            <div class="row gtr-uniform" style='margin-top:40px; margin-bottom:40px;'>
		              <div class="col-12">
		                <div class="p-3 border rounded bg-light">

		                <!--<a class="weatherwidget-io" href="https://forecast7.com/en/53d35n6d26/dublin/" data-label_1="DUBLIN" data-label_2="WEATHER" data-theme="original" data-basecolor="#142E54" data-lowcolor="#ffffff" data-raincolor="#ffffff" >DUBLIN WEATHER</a>
		                <script>
		                    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
		                </script>-->

		                <a class="weatherwidget-io" href="https://forecast7.com/en/53d35n6d26/dublin/" data-label_1="DUBLIN" data-label_2="WEATHER" data-theme="original" data-basecolor="#fff" data-accent="rgba(20, 46, 84, 0.02)" data-textcolor="#142E54" data-highcolor="#c34e2e" data-lowcolor="#142E54" data-mooncolor="#142E54" data-cloudcolor="#777777" data-raincolor="#142E54" >DUBLIN WEATHER</a>
				<script>
				!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
				</script>
				                
		                </div>
		              </div>
		   
		            </div>

		            <div class="row gtr-uniform" style='margin-top:40px;'>
		              <div class="col-4">
		                
		                <div class="p-3 border rounded bg-light">

		                   <!--<script type="text/javascript" src="http://moonphases.co.uk/js/widget.js" id="moonphase_widget" widget="tiny-times" lat="53.3498" lng="-6.2603" date="" tz=""></script>-->

		                <!-- © wdisseny --><div id="contain_moon" style="text-align:center;padding-top:5px;padding-bottom:5px;"><div style="font-weight:bold">Current Lunar Phase</div><div style="margin-top:-7px;margin-bottom:50px;padding:30px;filter:drop-shadow(0 0 30px hsl(219,100%,6%))"></div><div>.</div><div style="font-size:small">.</div></div><script>(function(){var d=new Date().getDate();var m=document.querySelectorAll("#contain_moon div");var a=new XMLHttpRequest();var url="https://www.icalendar37.net/lunar/api/?lang=en&month="+(new Date().getMonth()+1)+"&year="+(new Date().getFullYear())+"&size=100&lightColor=rgb(245,245,245)&shadeColor=rgb(57,57,57)&t&LDZ="+new Date(new Date().getFullYear(),new Date().getMonth(),1)/1000+"";m[1].style.height="100px";a.onreadystatechange=function(){if(a.readyState==4&&a.status==200){var b=JSON.parse(a.responseText);m[1].innerHTML=b.phase[d].svg;if(typeof moon_widget_loaded=="function")moon_widget_loaded(b);m[2].innerHTML=b.phase[d].npWidget;m[3].innerHTML="<br>Next full moon<br>"+b.nextFullMoon}};a.open("GET",url,true);a.send()})()</script>

		                </div>
		              </div>

		              <div class="col-8">

		                <div class="p-3 border rounded bg-light">
		                    <div id="chartContainer" style="height: 260px; width: 100%;"></div>
		                </div>
		              
		              </div>
		            </div>
		            
		            <div class="row gtr-uniform" style='margin-top:40px;'>
		              <div class="col-4">
		                <div class="p-3 border bg-light" style='padding:10px; border:1px solid #000; border-radius:5px;'>
		                    Solar Information for Dublin Today: <span class='todaydate'></span>. (UTC)</br></br>
		                    
		                    <div height='30px' style='line-height:30px;'><img src='images/sunrise (2).png' height='25px' style='margin-right:10px;'/>Sunrise: <span class='srise'></span></div></br>
		                    <div height='30px' style='line-height:30px;'><img src='images/sunset (1).png' height='25px' style='margin-right:10px;'/>Sunset: <span class='sset'></span></div></br>

		                    <div height='30px' style='line-height:30px;'><img src='images/solarnoon (1).png' height='25px' style='margin-right:10px;'/>Solar Noon: <span class='snoon'></span></div></br>
		                    <div height='30px' style='line-height:30px;'><img src='images/twilight.png' height='25px' style='margin-right:10px;'/>Lunar Phase: <span class='mphse'></span></div></br>

		                    <div height='30px' style='line-height:30px;'><img src='images/clock.png' height='25px' style='margin-right:10px;'/>Day Length: <span class='daylen'></span></div></br>
		                    <!--<div height='30px' style='line-height:30px;'><img src='assets/twilight.png' height='25px' style='margin-right:10px;'/>Astro. Twilight Begins: <span class='asttwibegin'></span></div></br>
		                    <div height='30px' style='line-height:30px;'><img src='assets/twilight.png' height='25px' style='margin-right:10px;'/>Astro. Twilight Ends: <span class='asttwiend'></span></div></br>-->
		                    <!--Icons created by Freepik, ThoseIcons, and PixelPerfect from flaticon.com -->
		                </div>
		              </div>
		              <div class="col-8">
		                <div class="p-3 border bg-light" style="font-weight:bold;text-align:center;padding-top:10px;padding-bottom:5px;">
		                    The Sun Now (SDO AIA)
		                    </br>
		                    <a href='https://sdo.gsfc.nasa.gov/data/' target='_blank'><img src="https://sdo.gsfc.nasa.gov/assets/img/latest/latest_2048_0171.jpg" height=220px width=220px style='border-radius:5px;margin-bottom:10px;'/></a>
		                    
		                    <a href='https://sdo.gsfc.nasa.gov/data/' target='_blank'><img src="https://sdo.gsfc.nasa.gov/assets/img/latest/latest_2048_HMIIC.jpg" height=220px width=220px style='border-radius:5px;margin-bottom:10px;'/></a>

		                </div>
		              </div>
		  
		            </div>


		         


		        </div>
		           

 
        	</section>

					

					</div>

				<!-- Footer -->
					<footer id="footer">
						<section id="cta">
							<h2>Get in Touch</h2>
							<p>I welcome opportunities to engage in public speaking, particularly at science festivals, open days, and similar events. Feel free to reach out with any enquiries.</p>
							<ul class="actions">
								<li><a href="https://jeremy.ie/speaking" class="button">See Previous Talks</a></li>
							</ul>
						</section>
						<section>
							<h2 style='color:#03220C;'>Contact Information</h2>
							<dl class="alt">
								<dt>Location</dt>
								<dd>Dublin &bull; Ireland</dd>
								<!--<dt>Phone</dt>
								<dd>(000) 000-0000 x 0000</dd>-->
								<dt>Email</dt>
								<dd><a href="#">jeremy.rigney [at] gmail [dot] com</a></dd>
							</dl>
							<ul class="icons">
								<li><a href="https://x.com/jeremyrigney" target='_blank' class="icon brands fa-x-twitter alt"><span class="label">Twitter</span></a></li>
								<li><a href="https://www.instagram.com/jeremy.rigney/" target='_blank' class="icon brands fa-instagram alt"><span class="label">Instagram</span></a></li>
								<li><a href="https://www.linkedin.com/in/jeremyrigney/" target="_blank" class="icon brands fa-linkedin alt"><span class="label">LinkedIn</span></a></li>
								<li><a href="https://github.com/jeremyrigney" target='_blank' class="icon brands fa-github alt"><span class="label">GitHub</span></a></li>
								<li><a href="https://scholar.google.com/citations?user=49Jj6VoAAAAJ&hl=en" target='_blank' class="icon brands fa-google-scholar alt"><span class="label">Google Scholar</span></a></li>
							</ul>
						</section>
						<p class="copyright">&copy;Template from <a href="https://html5up.net">HTML5 UP</a>.</p>
					</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>






    

        <script src="https://code.jquery.com/jquery-1.6.4.js"></script>
        <script type='text/javascript'>
            //var goesdata;
             var goesDataShort;
             var goesDataLong;
            $.getJSON('https://services.swpc.noaa.gov/json/goes/primary/xrays-3-day.json', function(data) {

                const energy = data.map(i => `${i.energy}`);
                const obs_flux = data.map(i => `${i.observed_flux}`);
                
                const times = data.map(i => `${i.time_tag}`);

                
                var short = [];
                var long = [];

                var shortData = [];
                var longData = [];

                let idx = energy.indexOf('0.05-0.4nm');
                while (idx != -1) {
                  short.push(obs_flux[idx])
                  idx = energy.indexOf('0.05-0.4nm', idx + 1);
                  
                };

                for (const x1 of short.keys()){
                    var temp = {x:new Date(Date.parse(times[x1])), y:parseFloat(short[x1])};
                    shortData.push(temp);
                };


                let idx2 = energy.indexOf('0.1-0.8nm');
                while (idx2 != -1) {
                  long.push(obs_flux[idx2])
                  idx2 = energy.indexOf('0.1-0.8nm', idx2 + 1);
                };

                for (const x2 of long.keys()){
                    var temp = {x:new Date(Date.parse(times[x2])), y:parseFloat(long[x2])};
                    longData.push(temp);
                };

            

            //console.log(goesDataLong);
            //window.onload = function () {

                var chart = new CanvasJS.Chart("chartContainer", {
                    zoomEnabled: true,
                    zoomType: "xy",
                    exportEnabled: true,
                    title: {
                        text: "GOES 3-Day X-Ray Data",
                        fontWeight:"normal",
                        fontSize:"16"
                    },
                    axisX: {
                        valueFormatString: "HH:MM DD/MM",
                        title: "TIme and Date"
                    },
                    axisY: {
                        logarithmic: true,
                        title: "Energy",
                        prefix: "",
                        suffix: "",
                        maximum: 0.0005,
                        minimum: 0.00000001,
                        labelFormatter: function ( e ) {
                            var ret;
                            switch(e.value){
                                case 0.00000001:
                                    ret = "A";
                                    break;
                                case 0.0000001:
                                    ret = "B";
                                    break;
                                case 0.000001:
                                    ret = "C";
                                    break;
                                case 0.00001:
                                    ret = "M";
                                    break;
                                case 0.0001:
                                    ret = "X";
                                    break;
        
                            }
                        return ret;
                        }
                    },

                    toolTip: {
                        shared: true
                    },



                    legend: {
                        cursor: "pointer",
                        verticalAlign: "top",
                        horizontalAlign: "center",
                        dockInsidePlotArea: true,
                        itemclick: toogleDataSeries
                    },
                    data: [{
                        type:"line",
                        //axisYType: "secondary",
                        name: "GOES 0.05-0.4 nm",
                        color:'#2C4770',
                        showInLegend: true,
                        markerSize: 1,
                        yValueFormatString: "#.##########",
                        dataPoints: shortData,
                        
                    },
                    {
                        type: "line",
                        //axisYType: "secondary",
                        name: "GOES 0.1-0.8 nm",
                        color:'#c34e2e',
                        showInLegend: true,
                        markerSize: 1,
                        yValueFormatString: "#.##########",
                        dataPoints: longData,

                    },
                    
                    ]
                });
                chart.render();
                
                function toogleDataSeries(e){
                    if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
                        e.dataSeries.visible = false;
                    } else{
                        e.dataSeries.visible = true;
                    }
                    chart.render();
                }
            
            //console.log(longData);
            //}
        });



        </script>


<script type='text/javascript'>
         
            $.getJSON('https://api.sunrise-sunset.org/json?lat=53.3871&lng=-6.3375&date=today', function(data) {

                //https://sunrise-sunset.org/api
                //$(".srise").html(data.results.sunrise);
                //$(".sset").html(data.results.sunset);
                $(".snoon").html(data.results.solar_noon);
                $(".daylen").html(data.results.day_length);
                $(".asttwibegin").html(data.results.astronomical_twilight_begin);
                $(".asttwiend").html(data.results.astronomical_twilight_end);


                var today = new Date();
                var dd = String(today.getDate()).padStart(2, '0');
                var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
                var yyyy = today.getFullYear();

                var today = dd + '/' + mm + '/' + yyyy;
                $(".todaydate").html(today);

            });


            $.getJSON('https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/Dublin?unitGroup=metric&include=current&key=WUTWMSAENKK9ZK69JSY48FJSQ&contentType=json', function(data) {
                $(".srise").html(data.currentConditions.sunrise);
                $(".sset").html(data.currentConditions.sunset);
                $(".mphse").html(data.currentConditions.moonphase);
                //console.log(data);
            });


            var x = new XMLHttpRequest();
            x.open("GET", "https://export.arxiv.org/api/query?search_query=all:star+AND+all:flare+AND+all:m+dwarf+NOT+all:fast+radio+bursts+NOT+all:neutron+stars+NOT+all:black+hole&start=0&max_results=3&sortBy=lastUpdatedDate&sortOrder=descending", true);
            x.onreadystatechange = function () {
                if (x.readyState == 4 && x.status == 200){
                    var doc = x.responseXML;
                    //console.log(doc)

                    $(".firsttitle").html(doc.getElementsByTagName("title")[1].textContent);
                    $(".secondtitle").html(doc.getElementsByTagName("title")[2].textContent);
                    $(".thirdtitle").html(doc.getElementsByTagName("title")[3].textContent);


                    var trimmedabs1 = doc.getElementsByTagName("summary")[0].textContent.substr(0, 270);
                    //re-trim if we are in the middle of a word
                    trimmedabs1 = trimmedabs1.substr(0, Math.min(trimmedabs1.length, trimmedabs1.lastIndexOf(" ")))
                    $(".firstabstract").html(trimmedabs1);
                    

                    var trimmedabs2 = doc.getElementsByTagName("summary")[1].textContent.substr(0, 270);
                    //re-trim if we are in the middle of a word
                    trimmedabs2 = trimmedabs2.substr(0, Math.min(trimmedabs2.length, trimmedabs2.lastIndexOf(" ")))
                    $(".secondabstract").html(trimmedabs2);
                    

                    var trimmedabs3 = doc.getElementsByTagName("summary")[2].textContent.substr(0, 270);
                    //re-trim if we are in the middle of a word
                    trimmedabs3 = trimmedabs3.substr(0, Math.min(trimmedabs3.length, trimmedabs3.lastIndexOf(" ")))
                    $(".thirdabstract").html(trimmedabs3);

                    var link1 = '<a href=\''+doc.getElementsByTagName("id")[1].textContent+'\' target=\'_blank\' style=\' text-decoration: none; color: #000; \'>Read on arXiv</a>'
                     $(".link1").html(link1);
                    var link2 = '<a href=\''+doc.getElementsByTagName("id")[2].textContent+'\' target=\'_blank\' style=\' text-decoration: none; color: #000; \'>Read on arXiv</a>'
                     $(".link2").html(link2)
                    var link3 = '<a href=\''+doc.getElementsByTagName("id")[3].textContent+'\' target=\'_blank\' style=\' text-decoration: none; color: #000; \'>Read on arXiv</a>'
                     $(".link3").html(link3);

                    var fruitName = doc.evaluate("/feed/entry[0]/author[1]", doc, null, XPathResult.ANY_TYPE, null);

                    a = doc.documentElement.childNodes;
                    var authorp1 = doc.getElementsByTagName("entry")[0].childNodes[11].textContent;
                    $(".authorp1").html(authorp1);
                    var authorp2 = doc.getElementsByTagName("entry")[1].childNodes[11].textContent;
                    $(".authorp2").html(authorp2);
                    var authorp3 = doc.getElementsByTagName("entry")[2].childNodes[11].textContent;
                    $(".authorp3").html(authorp3);

                    

                }
            };
            x.send(null);




</script>






<script>//http://127.0.0.1:5000/

const trainIcon = L.icon({
    iconUrl: 'images/train.png',  // or a full URL if hosted on GitHub Pages
    iconSize: [32, 18],            // size in pixels
    iconAnchor: [16, 32],          // point of the icon which corresponds to marker location
    popupAnchor: [0, -32]          // point from which the popup should open relative to the iconAnchor
});

const map = L.map('trainmap').setView([53.4495, -7.5030], 7);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap contributors',
}).addTo(map);

// Initialize trainMarkers array once
window.trainMarkers = [];

function loadTrains() {
  fetch('https://irishrail-api-737590149980.europe-west1.run.app')
    .then(res => res.json())
    .then(trains => {
      // Remove existing markers if any
      if (window.trainMarkers && Array.isArray(window.trainMarkers)) {
        window.trainMarkers.forEach(marker => marker.remove());
      }
      window.trainMarkers = [];

      // Add new markers
      trains.forEach(train => {
        const lat = parseFloat(train.TrainLatitude);
        const lon = parseFloat(train.TrainLongitude);
        const code = train.TrainCode;
        const message = train.PublicMessage;
        const messageparsed = message.replace(/\\n/g, '<br>');
        


        const marker = L.marker([lat, lon], { icon: trainIcon })
          .addTo(map)
          .bindPopup(`<strong>Train: ${code}</strong><br>${messageparsed}`);

        window.trainMarkers.push(marker);
      });
    })
    .catch(error => console.error('Error fetching train data:', error));
}
// Initial load
loadTrains();
//console.log('Map object:', trainmap);

// Refresh every 60 seconds
setInterval(loadTrains, 60000);

</script>

	</body>
</html>